/**
 * provides flat class definition
 * 
 * author:     D. Bird
 * copyright:  Copyright (c) 2012-2017 Garrison Koch, Doug Bird, and Daniel Lepthien. All Rights Reserved.
 * 
 * @module flat
 */var flat;(function(){if(typeof flat!="undefined")throw new Error("flat-js: 'flat' module already loaded");flat=function(){var e="/flat",t="flat.php",n={},r={},i=function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},s=!0;n.baseUrl=e,n.base_url=n.baseUrl;var o="flat/",u;try{storage.setItem(testKey,"1"),storage.removeItem(testKey),u=sessionStorage}catch(a){u=null}u||(u=function(){var e="sessionStorageShim/",t=function(t,n){var r=e+t,i=new Date;i.setTime(i.getTime()+31536e6);var s="expires="+i.toUTCString();document.cookie=r+"="+n+";"+s+";path=/"},r=function(t){var n=e+t,r=n+"=",i=document.cookie.split(";");for(var s=0;s<i.length;s++){var o=i[s];while(o.charAt(0)==" ")o=o.substring(1);if(o.indexOf(r)==0)return o.substring(r.length,o.length)}return""},i={};return i.getItem=function(e){if(!n.isString(e))throw new a("storage key: must be string");return r(e)},i.setItem=function(e,r){if(!n.isString(e))throw new a("storage key: must be string");if(!n.isString(r))throw new a("storage value: must be string");return t(e,r)},i}());var f=!1,l=null,c={touch:"touchend",mouse:"click"};n.set_click=function(e,t){c.touch=e,c.mouse=t},n.set_click=n.setClick,n.setTouchOn=function(e){typeof e!="undefined"&&(c.touch=e),l=!0},n.setTouchOff=function(){l=!1},n.isTouch=function(){return l===null&&(l="ontouchstart"in document.documentElement),l},n.is_touch=n.isTouch,n.ucwords=function(e){return(e+"").replace(/^([a-z\u00E0-\u00FC])|\s+([a-z\u00E0-\u00FC])/g,function(e){return e.toUpperCase()})},n.click_event=function(){return n.is_touch()?c.touch:c.mouse},n.q=function(e){return document.querySelector(e)},n.getUrl=function(e,r){var i=r;typeof i=="undefined"?i=t:i||(i="");if(e)return n.base_url+"/"+i+"/"+e;var s=n.base_url+"/"+i+"/";console.log("url..."),console.debug(s),document&&document.URL&&(s=document.URL);if(!s)throw"could not get url";return s},n.get_url=n.getUrl,n.getDebugOn=function(){return s?!0:!1},n.get_debug_on=n.getDebugOn,n.isObject=function(e){return e!==null&&typeof e=="object"?!0:!1},n.is_object=n.isObject,n.isFunc=function(e){return typeof e=="function"?!0:!1},n.is_func=n.isFunc,n.is_function=n.isFunc,n.isFunction=n.isFunc,n.isInt=function(e){return!e&&e!==0?!1:undefined===e||null===e?!1:e%1==0},n.is_int=n.isInt,n.isInteger=n.isInt,n.isString=function(e){return typeof e=="string"||e instanceof String?!0:!1},n.is_string=n.isString,n.isArray=function(e){return n.is_object(e)&&e.constructor===Array?!0:!1},n.is_array=n.isArray,n.data=function(e,t){var r=t,i;if(!e)throw"must provide key";if(!n.isString(e))throw"key must be string";var s=o+e;if(typeof r=="undefined"){r=u.getItem(s);if(r===null)return null;try{if(i=JSON.parse(r))return i}catch(a){return console.log("json error..."),console.debug(r),null}if(i===!1)return!1;if(i===null)return null;throw"invalid json for key '"+e+"'"}return u.setItem(s,JSON.stringify(r))},n.debug=function(e,t){var r=t;if(!s)return;n.isString(r)||(r="");if(console&&console.debug&&console.log){if(i(e)=="string"){r&&(r="debug ("+r+")"),r||(r="debug"),console.log(r+": '"+e+"'");return}r||(r="dump"),console.log("---(start "+i(e)+") "+r+":"),console.debug(e),console.log("---caller:"),f&&console.debug(printStackTrace()),console.log("---(end "+i(e)+")---")}};var h=null,p=[];r.parseQueryString=function(){if(h)return;h={};var e=null,t=window.location.href.split("?"),n;t&&t[1]&&(n=t[1].split("#"),n[0]&&(e=n[0]));if(!e)return!1;var r,i,s,o;r=e.split("&");for(s=0,o=r.length;s<o;s++)i=r[s].split("="),h[i[0]]=decodeURIComponent(i[1]);for(var u in h)p.push(u)},n.urlQueryString=function(){r.parseQueryString(),q=[];for(var e in h)q.push(encodeURIComponent(e)+"="+encodeURIComponent(h[e]));return q.join("&")},n.urlQueryKeyExists=function(e){return r.parseQueryString(),p.indexOf(e)!=-1},n.urlQuery_keyexists=n.urlQueryKeyExists,n.urlQueryKeyTruthy=function(e){return n.urlQuery_keyexists(e)&&typeof h[e]!="undefined"&&h[e]!="false"&&h[e]!="no"&&h[e]!="off"&&h[e]!="0"?!0:!1},n.urlQuery_keytruthy=n.urlQueryKeyTruthy,n.urlQueryVal=function(e){r.parseQueryString();if(h[e])return h[e]},n.urlQuery_val=n.urlQueryVal,n.urlQuerySet=function(e,t){r.parseQueryString();if(typeof t!="undefined"&&t!==null)h[e]=t,p.indexOf(e)==-1&&p.push(e);else{var i=p.indexOf(e);i!=-1&&(delete h[e],p.splice(i,1))}var s=window.location.pathname;p.length>0&&(s=s+"?"+n.urlQueryString()),window.history.pushState(null,null,s)},n.urlQuery_set=n.urlQuerySet,n.rand=function(e,t){var n=e,r=t;if(typeof n=="undefined"||n<0)n=0;if(typeof r=="undefined"||r>999999)r=999999;var i=Math.random().toString().replace(".","").substr(0,6);return i=parseInt(i),i*r+n};var d=function(){var e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},v=null,m=function(e){v||(v=d());var t=-1;for(var n=0;n<e.length;n++)t=t>>>8^v[(t^e.charCodeAt(n))&255];return(t^-1)>>>0};n.crc32=function(e){return m(e)};var g=[];for(var y=0;y<256;y++)g[y]=(y<16?"0":"")+y.toString(16);n.uuid=function(){var e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return g[e&255]+g[e>>8&255]+g[e>>16&255]+g[e>>24&255]+"-"+g[t&255]+g[t>>8&255]+"-"+g[t>>16&15|64]+g[t>>24&255]+"-"+g[n&63|128]+g[n>>8&255]+"-"+g[n>>16&255]+g[n>>24&255]+g[r&255]+g[r>>8&255]+g[r>>16&255]+g[r>>24&255]};var b={},w=[],E=[],S={},x={};r.procReadyQueue=!1,r.procReadyQueueUuuid=null,r.cleanReadyGarbage=!1,r.cleanReadyGarbageUuid=null;var T=function(){if(r.cleanReadyGarbage!==!1)return;if(r.cleanReadyGarbageUuuid!==null)return;r.cleanReadyGarbage=!0;var e=n.uuid();r.cleanReadyGarbageUuuid=e;var t=function(){setTimeout(function(){if(r.procReadyQueueUuuid!=procUuuid)return;if(n.rand(1,10)==1){var e;for(var i in x)e=x[i],flat.isObject(e)&&e.runtime!==null&&delete x[i]}t()},1e3)};t()},N=function(){if(r.procReadyQueue!==!1)return;if(r.procReadyQueueUuuid!==null)return;r.procReadyQueue=!0;var e=n.uuid();r.procReadyQueueUuuid=e;var t=function(){setTimeout(function(){if(r.procReadyQueueUuuid!=e)return;var n=S;if(n.length)for(var i in S){if(typeof flat[i]=="undefined")continue;if(E.indexOf(i)==-1)continue;if(!flat.isArray(S[i]))continue;var s=S[i].shift();if(!s||!flat.isString(s))continue;if(typeof x[s]=="undefined")continue;var o=x[s];if(!flat.isObject(o))throw new Error("flat-js: invalid readyItem in readyCallback["+i+"] item["+s+"]");if(o.status)continue;x[s].status=!0;if(!flat.isString(o.moduleName)){var u="flat-js: invalid moduleName readyItem["+i+"] item["+s+"]";o.status=new Error(u),console.warn(u);continue}if(o.moduleName!=i){var u="flat-js: moduleName mismatch in readyItem["+i+"] item["+s+"]";o.status=new Error(u),console.warn(u);continue}if(!flat.isFunc(o.callback)){var u="flat-js: invalid callback in readyItem["+i+"] item["+s+"]";o.status=new Error(u),console.warn(u);continue}o.callback.call(b[i]),x[s].runtime=+(new Date)}t()},150)};t(),T()};return n.ready=function(e,t){if(!e||!flat.isString(e))throw new Error("flat-js: invalid moduleName");if(!n.isFunc(t))throw new Error("flat-js: invalid callback");flat.isArray(S[e])||(S[e]=[]),setTimeout(function(){var r=n.uuid();x[r]={moduleName:e,created:+(new Date),callback:t,status:!1,runtime:null};if(w.indexOf(e)==-1){S[e].push(r);return}if(w.indexOf(e)==-1){S[e].push(r);return}},1)},n.load=function(e,t){if(!e||!flat.isString(e))throw new Error("flat-js: invalid moduleName");if(w.indexOf(e)!=-1)return;if(!flat.isObject(t)&&!flat.isFunction(t))throw new Error("flat-js: invalid module");w.push(e),b[e]=t,typeof flat[e]=="undefined"&&(flat[e]=b[e]),E.push(e)},n}()})();