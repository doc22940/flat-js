/**
 * Configure, show and hide an asynchronous-safe 'loading spinner' DOM overlay.  
 * 
 * author:     D. Bird
 * copyright:  Copyright (c) 2012-2017 Garrison Koch, Doug Bird, and Daniel Lepthien. All Rights Reserved.
 * 
 * @module flat/loadingOverlay
 */(function(){if(flat===null||typeof flat!="object"||typeof flat.load!="function")throw new Error("flat/loadingOverlay: missing flat-js");if(!jQuery)throw new Error("flat/loadingOverlay: missing jQuery");var e;(function(){var t=function(e){return e.toString().match(/\/\*\s*([\s\S]*?)\s*\*\//m)[1]},n=[];for(var r=0;r<256;r++)n[r]=(r<16?"0":"")+r.toString(16);var i=function(){var e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return n[e&255]+n[e>>8&255]+n[e>>16&255]+n[e>>24&255]+"-"+n[t&255]+n[t>>8&255]+"-"+n[t>>16&15|64]+n[t>>24&255]+"-"+n[r&63|128]+n[r>>8&255]+"-"+n[r>>16&255]+n[r>>24&255]+n[i&255]+n[i>>8&255]+n[i>>16&255]+n[i>>24&255]},s=function(){var e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},o=null,u=function(e){o||(o=s());var t=-1;for(var n=0;n<e.length;n++)t=t>>>8^o[(t^e.charCodeAt(n))&255];return(t^-1)>>>0},a=function(){var e="lo",t="lo-"+i(),n={wrapClass:e+"-wrap",spinClass:e+"-spin",spinID:t,target:"body",spinMinMS:300,spinWaitMS:100},r=function(e){return u(e.wrapClass+e.spinClass+e.spinID)},s={};return{uuid:i,cache:function(e,t){var n=r(e);return s[n]?s[n]:(s[n]=t(),s[n])},config2param:function(e){var t=n;if(typeof e=="undefined"||typeof e!="object")return t;for(var r in t)typeof e[r]!="undefined"&&(t[r]=e[r]);return t}}}();e=function(e){var n=a.config2param(e);return a.cache(n,function(){var e="#"+n.spinID,r="",s=!1,o,u={invoked:!1,cb:null},f={},l={},c={status:!1,cb_hash:{}},h={},p=function(){var t=i();return r=t,s=!1,l[t]=!1,h[t]=c,setTimeout(function(){if(l[t]==1)return;if(s&&r==t)return s=!1,r=null,!1;if(r!=t)return!1;o=Date.now(),$(e).show()},n.spinWaitMS),t},d=n.spinMinMS,v=function g(t,n,i){var p;typeof i=="undefined"?p=a.uuid():p=i;if(l[t]===!0){typeof f[p]!="undefined"&&(f[p].invoked||(f[p].invoked=!0,f[p]()));return}f[p]=u,typeof n!="undefined"&&(f[p].cb=n),typeof h[t]=="undefined"&&(h[t]=c),h[t].cb_hash[p]=f[p],s=!0,setTimeout(function(){if(t!=r){l[t]=!0;if(typeof n=="function"){f[p].invoked=!0,h[t].cb_hash[p].invoked=!0,n();for(var i in h[t].cb_hash)!h[t].cb_hash[i].invoked&&typeof h[t].cb_hash[i].cb=="function"&&(h[t].cb_hash[i].invoked=!0,h[t].cb_hash[i].cb())}return}var s=Date.now()-o;if(s<d)setTimeout(function(){g(t,n,p)},10);else{$(e).hide(),l[t]=!0;if(typeof n=="function"){h[t].cb_hash[p].invoked=!0,f[p].invoked=!0,n();for(var i in h[t].cb_hash)!h[t].cb_hash[i].invoked&&typeof h[t].cb_hash[i].cb=="function"&&(h[t].cb_hash[i].invoked=!0,h[t].cb_hash[i].cb())}}},10)};typeof cancelSpinnerCallee=="undefined";var m={cancel:v,activate:p};return $(e).length&&$(e).hasClass(n["class"])?m:($(n.target).append(t(function(){}).replace(/%wrapClass%/g,n.wrapClass).replace(/%spinClass%/g,n.spinClass)),$(n.target).append(t(function(){}).replace(/%wrapClass%/g,n.wrapClass).replace(/%spinID%/g,n.spinID)),m)})}})(),flat.load("loadingOverlay",e)})();